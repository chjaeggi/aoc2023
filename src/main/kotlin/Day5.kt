class Day5() {

    val seed2SoilString = "2067746708 2321931404 124423068\n" +
            "2774831547 3357841131 95865403\n" +
            "3776553292 3323317283 34523848\n" +
            "4167907733 3453706534 116376261\n" +
            "1190847573 767701596 554806188\n" +
            "2870696950 1975607604 173919437\n" +
            "1980384731 2612856575 87361977\n" +
            "3380570559 2987564153 335753130\n" +
            "3044616387 2451131599 21188806\n" +
            "3909556885 2167390152 154541252\n" +
            "3811077140 2149527041 17863111\n" +
            "4077167815 3804196813 90739918\n" +
            "2528751611 4222771775 72195521\n" +
            "4064098137 3894936731 13069678\n" +
            "4284283994 2700218552 10683302\n" +
            "2468832075 2472320405 59919536\n" +
            "3716323689 3570082795 60229603\n" +
            "1085396685 662250708 105450888\n" +
            "1030174777 1322507784 22912174\n" +
            "1975607604 2446354472 4777127\n" +
            "3828940251 2532239941 80616634\n" +
            "584992388 1930412346 7315040\n" +
            "592307428 0 437867349\n" +
            "1745653761 437867349 224383359\n" +
            "0 1345419958 584992388\n" +
            "2192169776 2710901854 276662299\n" +
            "2600947132 3630312398 173884415\n" +
            "1053086951 1937727386 32309734\n" +
            "3065805193 3908006409 314765366"
    val soil2FertilizerString = "4148533839 3658735071 146433457\n" +
            "656556737 471425735 68165409\n" +
            "751630557 539591144 462446129\n" +
            "724722146 1002037273 26908411\n" +
            "0 24799538 226917727\n" +
            "4049709448 3143711443 98824391\n" +
            "412048729 251717265 219708470\n" +
            "3321838617 2645077606 72145759\n" +
            "3869354568 2464722726 180354880\n" +
            "2044900648 1380852911 42721698\n" +
            "226917727 1028945684 185131002\n" +
            "3111204505 2717223365 210634112\n" +
            "2129227343 1423574609 981977162\n" +
            "1380852911 2927857477 215853966\n" +
            "3393984376 2405551771 59170955\n" +
            "3453155331 3242535834 416199237\n" +
            "1596706877 3805168528 448193771\n" +
            "2087622346 4253362299 41604997\n" +
            "631757199 0 24799538"
    val fertilizer2WaterString = "2679101382 2898500255 208361454\n" +
            "3672966601 3700867560 107718031\n" +
            "1764241275 4242224976 41519499\n" +
            "1018987051 346629037 49456831\n" +
            "518817716 396085868 3722249\n" +
            "1224466235 306138732 40490305\n" +
            "1068679130 947256497 122607155\n" +
            "1328820253 625833852 156797976\n" +
            "222363356 782631828 128136603\n" +
            "4106081288 2497628211 144953761\n" +
            "2887462836 1577782207 70654427\n" +
            "2453719866 2077230479 225381516\n" +
            "2177283137 3415053348 9638645\n" +
            "1485618229 910768431 36488066\n" +
            "1805760774 2833622399 32168430\n" +
            "482104460 0 36713256\n" +
            "4065926174 2480721173 16907038\n" +
            "118194361 213050410 93088322\n" +
            "1869091498 3106861709 308191639\n" +
            "1068443882 399808117 235248\n" +
            "2958117263 3926610020 315614956\n" +
            "1577782207 2324396806 156324367\n" +
            "1270677460 36713256 58142793\n" +
            "1264956540 586932982 5720920\n" +
            "1847306687 2302611995 21784811\n" +
            "843178107 411124038 175808944\n" +
            "1191286285 592653902 33179950\n" +
            "4251035049 4283744475 11222821\n" +
            "4262257870 2865790829 32709426\n" +
            "4082833212 2810374323 23248076\n" +
            "3273732219 2642581972 167792351\n" +
            "350499959 1069863652 131604501\n" +
            "3780684632 1859496740 217733739\n" +
            "3441524570 3808585591 118024429\n" +
            "3998418371 1791988937 67507803\n" +
            "1837929204 3691490077 9377483\n" +
            "1734106574 1761854236 30134701\n" +
            "211282683 400043365 11080673\n" +
            "2186921782 3424691993 266798084\n" +
            "522539965 1201468153 320638142\n" +
            "3559548999 1648436634 113417602\n" +
            "0 94856049 118194361"
    val water2LightString = "487890089 1253174910 48217379\n" +
            "1162866447 2295971038 331509140\n" +
            "3115016077 4085918002 209049294\n" +
            "3600618057 2743705059 694349239\n" +
            "3021490874 3712826169 26810261\n" +
            "2743705059 3739636430 3013944\n" +
            "3048301135 4019203060 66714942\n" +
            "1494375587 0 650888870\n" +
            "167398115 650888870 320491974\n" +
            "78943404 2207516327 88454711\n" +
            "3324065371 3742650374 276552686\n" +
            "881072381 1174877356 78297554\n" +
            "2690077973 2191170718 16345609\n" +
            "2746719003 3438054298 274771871\n" +
            "2145264457 1301392289 544813516\n" +
            "959369935 971380844 203496512\n" +
            "536107468 1846205805 344964913\n" +
            "0 2627480178 78943404"
    val light2TemperatureString = "2934276762 3692860946 134937994\n" +
            "2222730788 3468116804 32924074\n" +
            "2030910720 3501040878 191820068\n" +
            "2876227610 3450265581 17851223\n" +
            "2821863146 1926340324 54364464\n" +
            "2894078833 3827798940 40197929\n" +
            "0 2499885250 950380331\n" +
            "3069214756 1312743837 613596487\n" +
            "950380331 232213448 1080530389\n" +
            "2302682684 2382183979 117701271\n" +
            "3682811243 47027822 185185626\n" +
            "2255654862 0 47027822\n" +
            "2420383955 1980704788 401479191"
    val temperature2HumidityString = "3474899002 2152529659 335631613\n" +
            "1227362297 2657517973 1047434675\n" +
            "1147289328 4214894327 80072969\n" +
            "3069802422 3704952648 405096580\n" +
            "4233143053 2090705416 61824243\n" +
            "3979887316 1837449679 253255737\n" +
            "3810530615 2488161272 169356701\n" +
            "1042444229 4110049228 104845099\n" +
            "2274796972 1042444229 718141444\n" +
            "2992938416 1760585673 76864006"
    val humidity2LocationString = "2905941546 1669212802 106379169\n" +
            "3490393041 2571512629 24111360\n" +
            "3327134512 896350741 163258529\n" +
            "163044169 321738120 136537257\n" +
            "1794114599 1475899779 31051829\n" +
            "1155727752 771777629 98456450\n" +
            "3514504401 1890601528 199093442\n" +
            "3241757362 1290456090 8146812\n" +
            "3713597843 2595623989 446677438\n" +
            "2865335819 1388663285 15697510\n" +
            "3155553665 2166925308 86203697\n" +
            "26879537 567441866 52236777\n" +
            "421556320 59735378 198122323\n" +
            "4160275281 1059609270 134692015\n" +
            "1072793086 2488577963 82934666\n" +
            "2006477848 3530988938 680918581\n" +
            "1766297705 1528152733 5360386\n" +
            "1405780686 3214887893 74444149\n" +
            "3017788788 1533513119 135699683\n" +
            "977736160 4211907519 83059777\n" +
            "1771658091 2466121455 22456508\n" +
            "2687396429 870234079 26116662\n" +
            "79116314 547394430 20047436\n" +
            "2773054926 1506951608 21201125\n" +
            "1825166428 3289332042 181311420\n" +
            "2713513091 1404360795 59541835\n" +
            "3012320715 1213908249 5468073\n" +
            "3249904174 2089694970 77230338\n" +
            "2794256051 1219376322 71079768\n" +
            "1601513875 2253129005 74723447\n" +
            "3153488471 769712435 2065194\n" +
            "299581426 41300579 18434799\n" +
            "332437267 458275377 89119053\n" +
            "1273791166 2327852452 131989520\n" +
            "1676237322 1298602902 90060383\n" +
            "318016225 26879537 14421042\n" +
            "769712435 3470643462 60345476\n" +
            "2881033329 3042301427 24908217\n" +
            "1480224835 2459841972 6279483\n" +
            "99163750 257857701 63880419\n" +
            "1060795937 1463902630 11997149\n" +
            "830057911 3067209644 147678249\n" +
            "1254184202 1194301285 19606964\n" +
            "1486504318 1775591971 115009557"

    val seeds = listOf<Long>(
        1636419363,
        608824189,
        3409451394,
        227471750,
        12950548,
        91466703,
        1003260108,
        224873703,
        440703838,
        191248477,
        634347552,
        275264505,
        3673953799,
        67839674,
        2442763622,
        237071609,
        3766524590,
        426344831,
        1433781343,
        153722422
    )

    private val seed2Soil = mutableMapOf<LongRange, Long>()
    private val soil2Fertilizer = mutableMapOf<LongRange, Long>()
    private val fertilizer2Water = mutableMapOf<LongRange, Long>()
    private val water2Light = mutableMapOf<LongRange, Long>()
    private val light2Temperature = mutableMapOf<LongRange, Long>()
    private val temperature2Humidity = mutableMapOf<LongRange, Long>()
    private val humidity2Location = mutableMapOf<LongRange, Long>()

    init {
        seed2SoilString.convertTo(seed2Soil)
        soil2FertilizerString.convertTo(soil2Fertilizer)
        fertilizer2WaterString.convertTo(fertilizer2Water)
        water2LightString.convertTo(water2Light)
        light2TemperatureString.convertTo(light2Temperature)
        temperature2HumidityString.convertTo(temperature2Humidity)
        humidity2LocationString.convertTo(humidity2Location)
    }

    private fun String.convertTo(map: MutableMap<LongRange, Long>) {
        val str = split("\n")
        str.forEach {
            val line = it.split(" ")
            val sourceStart = line[1].toLong()
            val range = line[2].toLong()
            val destStart = line[0].toLong()
            map[sourceStart..<sourceStart + range] = destStart
        }
    }

    private fun Long.findNext(map: Map<LongRange, Long>): Long {
        var found = false
        var next = (-1).toLong()
        for (key in map.keys) {
            if (key.contains(this)) {
                found = true
                next = this - (key.first - map[key]!!)
                break
            }
        }
        if (!found) {
            next = this
        }
        return next
    }

    fun solveFirst() {
        val listOfLocations = mutableListOf<Long>()
        seeds.forEach { number ->
            listOfLocations.add(
                number
                    .findNext(seed2Soil)
                    .findNext(soil2Fertilizer)
                    .findNext(fertilizer2Water)
                    .findNext(water2Light)
                    .findNext(light2Temperature)
                    .findNext(temperature2Humidity)
                    .findNext(humidity2Location)
            )
        }
        println(listOfLocations.minOf{ it })
    }

    fun solveSecond() {
        val starts = mutableListOf<Long>()
        val ranges = mutableListOf<Long>()
        val seedsComplete = mutableListOf<LongRange>()
        for ((idx, value) in seeds.withIndex()) {
            if (idx % 2 == 0) {
                starts.add(value)
            } else {
                ranges.add(value)
            }
        }
        for ((idx, element) in starts.withIndex()) {
            seedsComplete.add(element until element + ranges[idx])
        }
        var currentMin = Long.MAX_VALUE
        seedsComplete.forEach {
            it.forEach {
                val localMin = it
                    .findNext(seed2Soil)
                    .findNext(soil2Fertilizer)
                    .findNext(fertilizer2Water)
                    .findNext(water2Light)
                    .findNext(light2Temperature)
                    .findNext(temperature2Humidity)
                    .findNext(humidity2Location)
                if (currentMin > localMin) {
                    currentMin = localMin
                    println(currentMin)
                }
            }
        }
    }
}